<!DOCTYPE html>
<html>
  <head>
    <style>
      /*  Base */
      body{
        margin:0;min-height:100vh;
        display:flex;justify-content:center;align-items:center;
        background:linear-gradient(135deg,#667eea,#764ba2);
        font-family:sans-serif;
        .container, .modal { cursor:auto; } /* keep cursor visible in modal */
        #weapon{pointer-events:none} /* weapon will follow cursor during game */
      }
      .container{
        background:#fff;padding:25px;
        border-radius:15px;text-align:center;
        box-shadow:0 15px 40px rgba(0,0,0,.25)
      }

      /* Game Grid */
      .grid{
        display:grid;
        grid-template:repeat(3,120px)/repeat(3,120px);
        gap:18px;margin:25px auto
      }
      .cell{
        background:#e8f5e9;border:3px solid #4caf50;
        display:flex;justify-content:center;align-items:center;
        font-size:2.8em;cursor:pointer;
        border-radius:12px;
        transition:.15s
      }
      .cell:hover{transform:scale(1.05)}
      .cell.mole::before{content:'ü¶´'}
      .cell.hit::before{content:'üí•'}
      .cell img{width:85px;height:85px;border-radius:50%}

      /* Weapon Cursor  */
      #weapon{
        position:fixed;pointer-events:none;
        font-size:4em;
        transform:translate(-50%,-50%);
        z-index:1000
      }

      /* Modals */
      .modal{
        position:fixed;inset:0;
        background:rgba(0,0,0,.55);
        display:flex;justify-content:center;align-items:center
      }
      .box{
        background:linear-gradient(135deg,#ffffff,#f3f4ff);
        padding:30px;border-radius:18px;
        text-align:center;width:280px;
        box-shadow:0 20px 50px rgba(0,0,0,.3);
        animation:pop .3s ease
      }
      .box h3{margin-top:0}
      .box button{
        padding:10px 18px;border:none;
        background:#667eea;color:#fff;
        border-radius:8px;cursor:pointer;
        font-size:1em
      }
      .box button:hover{background:#5563d6}
      .hidden{display:none}

      @keyframes pop{
        from{transform:scale(.8);opacity:0}
        to{transform:scale(1);opacity:1}
      }
    </style>
  </head>

<body>
  <!-- START MODAL -->
  <div class="modal" id="startBox">
    <div class="box">
      <h3>üéØ Whack-a-Mole</h3>
      <p>Choose your weapon</p>
      <select id="w">
        <option value="ü©¥">Slipper</option>
        <option value="üç≥">Pan</option>
        <option value="üóûÔ∏è">Rolling Pin</option>
      </select><br><br>
      <input type="file" id="img" accept="image/*"><br><br>
      <button onclick="init()">Start Game</button>
    </div>
  </div>

  <!-- END MODAL -->
  <div class="modal hidden" id="endBox">
    <div class="box">
      <h3>üèÅ Game Over</h3>
      <p id="result"></p>
      <button onclick="location.reload()">Play Again</button>
    </div>
  </div>
  <!-- Weapon Cursor -->
  <div id="weapon"></div>

  <!-- Game -->
  <div class="container">
    <h2>Whack-a-Mole</h2>
    <div>Score: <span id="s">0</span> | Time: <span id="t">30</span>s</div>
    <div class="grid" id="g"></div>
  </div>

    <script>
      let s=document.getElementById('s'), t=document.getElementById('t'), g=document.getElementById('g'), w=document.getElementById('w'),
          imgInput=document.getElementById('img'), weapon=document.getElementById('weapon'),
          startBox=document.getElementById('startBox'), endBox=document.getElementById('endBox'),
          result=document.getElementById('result');

      let cells=[],score=0,time=30,active=false,
          timer,mole,moleSpeed=800,
          userImg=null,
          high=localStorage.getItem('high')||0;

      /* optional image upload */
      imgInput.onchange=e=>userImg=URL.createObjectURL(e.target.files[0]);

      /* create 9 cells */
      for(let i=0;i<9;i++){
        let d=document.createElement('div');
        d.className='cell';
        d.onclick=()=>{
          if(active && d.classList.contains('mole') || d.classList.contains('mole-img')){
            score++; s.textContent=score;
            d.dataset.w=w.value;
            d.className='cell hit';
            d.innerHTML = ''; 
            weapon.style.transform='translate(-50%,-50%) rotate(-25deg)';
            setTimeout(()=>{
              d.className='cell';
              weapon.style.transform='translate(-50%,-50%)';
            },150);
          }
        };
        g.append(d); cells.push(d);
      }

      /* start from modal */
      function init(){
        weapon.textContent=w.value;
        startBox.classList.add('hidden');
        document.onmousemove=e=>{
          weapon.style.left=e.clientX+'px';
          weapon.style.top=e.clientY+'px';
        };
        start();
      }

      /* start game */
      function start(){
        score = 0;
        time = 30;
        active = true;
        s.textContent = 0;
        t.textContent = time;
                            
        cells.forEach(c => {          // reset all cells
          c.className = 'cell'; 
          c.innerHTML = ''; 
        });
        clearInterval(timer);
        clearInterval(mole);
        // game timer (counts down 1 sec)
        timer = setInterval(() => {
          if (--time <= 0) end();
          t.textContent = time;
        }, 1000);

        // mole/image spawner
        mole = setInterval(() => {
          // reset all cells
          cells.forEach(c => { c.className = 'cell'; c.innerHTML = ''; });

          // pick random cell
          let r = cells[Math.floor(Math.random() * 9)];

          if (userImg) {
            r.classList.add('mole-img');         // uploaded image
            r.innerHTML = `<img src="${userImg}">`;
          } else {
            r.classList.add('mole');             // default mole emoji
          }
        }, moleSpeed);
      }

      /* end game + high score */
      function end(){
        active=false;
        clearInterval(timer); clearInterval(mole);
        if(score>high){
          high=score;
          localStorage.setItem('high',high);
        }
        result.innerHTML=`Score: ${score}<br>High Score: ${high}`;
        endBox.classList.remove('hidden');
      }
    </script>
</body>
</html>
